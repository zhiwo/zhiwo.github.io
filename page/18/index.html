<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="知我">
<meta property="og:url" content="http://hi.holdlg.com/page/18/index.html">
<meta property="og:site_name" content="知我">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="知我">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> 知我 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?6adc065ab3239e94c39287e9a4b71c1f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">知我</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/06/20/20132015/WP的软键盘操作/" itemprop="url">
                  WP的软键盘操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-06-20T15:55:49+08:00" content="2013-06-20">
              2013-06-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>前台UI：</p>
<p><pre></pre></p>
<p>&lt;phone:PhoneApplicationPage</p>
<p><grid x:name="LayoutRoot" background="Transparent"></grid></p>
<p><stackpanel orientation="Vertical"><br><!--SIP 包含数字和小数点，按住句号键可以显示“.,-”--></stackpanel></p>
<p><textbox inputscope="Number"><br><!--SIP 按“123”键切换到电话号码键盘，按住句号键可以显示“.,-”--></textbox></p>
<p><textbox inputscope="NameOrPhoneNumber"><br><!--SIP 默认显示数字和符号键盘--></textbox></p>
<p><textbox inputscope="CurrencyChinese"><br><!--SIP 显示电话拨号键盘--></textbox></p>
<p><textbox></textbox></p>
<p><textbox.inputscope></textbox.inputscope></p>
<p><inputscope></inputscope></p>
<p><inputscopename namevalue="TelephoneNumber"><br><br><br><br><!--后台将此 TextBox 的 InputScope 设置为“EmailUserName”--><br><!--SIP 包括 @ 和 .com 键，按住 .com 键可以显示“.org .com .edu .net”--></inputscopename></p>
<p><textbox name="textBox" keydown="textBox_KeyDown"><br><br><br></textbox></p>
<p>后台：<br>//获取软键盘上面的搜索键，也就是在此判断搜索的结果<br>private void textBox<em>KeyDown(object sender, KeyEventArgs e)<br>{<br>// 判断用户是否按下了 SIP 上的回车键<br>if (e.Key == Key.Enter)<br>{<br>MessageBox.Show(“用户按下了回车键”);<br>// 转移焦点，虚拟键盘会自动隐藏<br>this.Focus();<br>}<br>}<br>}Input scopes<br><img src="http://i.msdn.microsoft.com/dynimg/IC530993.png" alt="Keyboard 4" title="Keyboard 4"><br>描述：Includes auto-correction, suggestions, and emoticons.<br><strong>Input scopes：</strong>Text<br><img src="http://i.msdn.microsoft.com/dynimg/IC530994.png" alt="Keyboard 1" title="Keyboard 1"><br>描述：The default keyboard<br><strong>Input scopes：</strong><br>AddressCity, AddressCountryName,AddressCountryShortName, AddressStateOrProvince,AddressStreet<em>, AlphanumericFullWidth,AlphanumericHalfWidth, Bopomofo, DateDayName,DateMonthName, Default, FileName, FullFilePath, Hanja,Hiragana, KatakanaFullWidth, KatakanaHalfWidth,LogOnName, OneChar, Password, PersonalFullName,PersonalGivenName, PersonalMiddleName,PersonalNamePrefix, PersonalNameSuffix, Yomi</em>AddressStreet produces this keyboard when the keyboard language on the phone or emulator is set to any language other than English, French, Filipino, Malay, or Indonesian.<br><img src="http://i.msdn.microsoft.com/dynimg/IC530995.png" alt="Keyboard 6" title="Keyboard 6"><br>描述：<br>Includes the @ and .comkeys. Press and hold the.com key to display additional options (.org .com .edu .net).<br><strong>Input scopes：</strong>EmailNameOrAddress, EmailSmtpAddress, EmailUserName<br><img src="http://i.msdn.microsoft.com/dynimg/IC530996.png" alt="Keyboard 10" title="Keyboard 10"><br>描述：<br>Includes the .com key. Press and hold the .comkey to display additional options (.com .org .edu .net). Press and hold the period key to display additional options (- + &amp; “ : . /).<br><strong>Input scopes：</strong>Url<br><img src="http://i.msdn.microsoft.com/dynimg/IC530997.png" alt="Keyboard 8" title="Keyboard 8"><br>描述：<br>Press the 123 key to change to the telephone number keyboard. Press and hold the period key to display additional options (- </em> , .).<br><strong>Input scopes：</strong>NameOrPhoneNumber<br><img src="http://i.msdn.microsoft.com/dynimg/IC530998.png" alt="Keyboard 2" title="Keyboard 2"><br>描述：Contains numbers and symbols.<br><strong>Input scopes：</strong><br>AddressStreet<em>, CurrencyAmountAndSymbol,CurrencyChinese, PostalAddress, PostalCode, Time</em>AddressStreet produces this keyboard when the keyboard language on the phone or emulator is set to English, French, Filipino, Malay, or Indonesian.<br><img src="http://i.msdn.microsoft.com/dynimg/IC530999.png" alt="Keyboard 9" title="Keyboard 9"><br>描述：<br>Mimics the telephone keypad. Press and hold the period key to display additional options (, ( ) X .). Press and hold the 0 key to enter +.<br><strong>Input scopes：</strong><br>TelephoneAreaCode, TelephoneCountryCode,TelephoneLocalNumber, TelephoneNumber<br><img src="http://i.msdn.microsoft.com/dynimg/IC531000.png" alt="Keyboard 5" title="Keyboard 5"><br>描述：Contains numbers and a decimal point. Press and hold the period key to display additional options (. , -).<br><strong>Input scopes：</strong><br>CurrencyAmount, DateDay, DateMonth, DateYear, Digits,Number, NumberFullWidth, NumericPassword, TimeHour,TimeMinorSec<br><img src="http://i.msdn.microsoft.com/dynimg/IC531001.png" alt="Keyboard 7" title="Keyboard 7"><br>描述：Includes suggestions.<br><strong>Input scopes：</strong>Maps, Search<br><img src="http://i.msdn.microsoft.com/dynimg/IC531002.png" alt="Keyboard 3" title="Keyboard 3"><br>描述：<br>Includes suggestions. Press and hold the equal key for additional options ( ( = ) : &lt; &gt; ). Press the&amp;123 key to change to the number and symbol keyboard, optimized for entering numeric formulas.<br><strong>Input scopes：</strong>Formula<br><img src="http://i.msdn.microsoft.com/dynimg/IC530993.png" alt="Keyboard 4" title="Keyboard 4"><br>描述：Includes suggestions and emoticons, but not auto-correction.<br><strong>Input scopes：</strong>Chat</p>
<p><div><strong>END：</strong></div></p>
<p><div><img src="http://i.msdn.microsoft.com/areas/global/content/clear.gif" alt="Important note" title="Important note"><strong>Important Note:</strong><br>The following Input scopes are not supported in Windows Phone applications: ApplicationEnd, EnumString, PhraseList, Private,RegularExpression, Srgs, Xml.</div></p>
<table><br><tbody><br><tr><br><th>Keyboard</th><br><th>Notes</th><br></tr><br></tbody><br></table>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/06/18/20132015/批处理获取当前路径/" itemprop="url">
                  批处理获取当前路径
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-06-18T10:23:30+08:00" content="2013-06-18">
              2013-06-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/cmd/" itemprop="url" rel="index">
                    <span itemprop="name">cmd</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">### @<span class="keyword">echo</span> off</span><br><span class="line"><span class="keyword">echo</span> 当前盘符：%~d0</span><br><span class="line"><span class="keyword">echo</span> 当前盘符和路径：%~dp0</span><br><span class="line"><span class="keyword">echo</span> 当前批处理全路径：%~f0</span><br><span class="line"><span class="keyword">echo</span> 当前盘符和路径的短文件名格式：%~sdp0</span><br><span class="line"><span class="keyword">echo</span> 当前<span class="built_in">CMD</span>默认目录：<span class="envvar">%cd%</span></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>
<p>原文来自:<a href="http://cys15898.blog.163.com/blog/static/21543707420132445259341/" target="_blank" rel="external">http://cys15898.blog.163.com/blog/static/21543707420132445259341/</a></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/06/04/20132015/wp入门开发/" itemprop="url">
                  wp入门开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-06-04T17:04:08+08:00" content="2013-06-04">
              2013-06-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><strong>一、设置地图初始化视野</strong></p>
<p><pre><br>注:如果利用XAML设置视野会给ExtentChanged事件造成死循环，建议后台设置<br> &lt;!–Extent标签用来初始地图的范围，通过设置4格数值指定min x,min y,max x,max y相当于于BingMap for Silverlight中的2个Location点Location(60,60) 和另一点Location(13,140)来初始化地图为中国地图</pre></p>
<p><esri:map.extent></esri:map.extent></p>
<p><esrigeometry:envelope xmin="661140" ymin="-1420246" xmax="3015668" ymax="1594451"></esrigeometry:envelope></p>
<p><esrigeometry:envelope.spatialreference></esrigeometry:envelope.spatialreference></p>
<p><esrigeometry:spatialreference wkid="26777"><br><br><br><br><strong>二、模拟定位，以及视野以当前位置画圆</strong></esrigeometry:spatialreference></p>
<p><pre>MapPoint mapPoint=new MapPoint(116.3880556,39.907325)北京天安门坐标<br>private void MyMap_ExtentChange(object sender,ExtentEventArcgs e)<br>{<br>this.MyMap.Panto(mapPoint)<br>}</pre><br>使用GraphicsLayer从后台中获得当前的位置，然后构造一个Point类型的Graphic 并设置点的符号， 添加到GraphicsLayer中，这里需要事先定义GeoCoordinateWatcher，并注册位置变化事件。在位置变化事件里不断的获得位置<br>GeoCoordinateWatcher只能获得WGS 84坐标系下的经纬度，我们可以根据底图的参考系来进行转换，如果底图本来就是WGS84坐标系的话，就不需要转换了，如果是webmercator空间坐标系的话，可以使用WebMercator来完成地理坐标与空间坐标的转换，如果是其他的坐标系的话，应当使用几何服务。</p>
<p><pre>void watcher_PositionChanged(object sender, GeoPositionChangedEventArgs e)<br>{<br>ESRI.ArcGIS.Client.Projection.WebMercator mercator = new ESRI.ArcGIS.Client.Projection.WebMercator();<br>_graphicLocation.Geometry = mercator.FromGeographic(new MapPoint(e.Position.Location.Longitude, e.Position.Location.Latitude));<br>}</pre><br><strong>三、使用StackPanel中动态添加控件</strong><br>由于StackPanel添加控件挤一块不美观，所以可采用Margin调整距离<br>提供对象的边距值。 默认值是所有属性（维度）都等于 0 的默认 Thickness。<br>XAML 值</p>
<p><pre><frameworkelement margin="uniform"></frameworkelement></pre></p>
<ul>
<li>or -<frameworkelement margin="left+right,top+bottom"></frameworkelement></li>
<li>or -<br><frameworkelement margin="left,top,right,bottom"><br>uniform<br>一个以像素为单位度量的值，用于指定统一的 Thickness。 uniform 值应用于全部四个 Thickness 属性（Left、Top、Right、Bottom）。<br>left+right<br>一个以像素为单位度量的值，用于指定对称 Thickness 的 Left 和 Right。<br>top+bottom<br>一个以像素为单位度量的值，用于指定对称 Thickness 的 Top 和 Bottom。<br>left top right bottom<br>以像素为单位度量的值，用于指定 Thickness 结构的四个可能的维度属性（Left、Top、Right、Bottom）。<br><strong>四、控件Button按钮如果变成圆角</strong><br><pre>1、利用Blend进行设计<br>2、选中按钮，右键编辑模板——新建空模板——选中Grid——右键更改模板样式——选中border——如果需要显示按钮上面的文字，则里面需要放一个leabel控件，如果设置图片直接背景设置——更改CornerRadius（设置值：15）可以设置成圆角，选中状态——pressed（点击时）向右下角偏移——设置Projection中的x（5），y（5）然后即可。</pre><br><strong>五、ArcGIS API for Silverlight 地图加载进度条类之MapProgressBar</strong><br><pre>注意调整BorderBrush、Background、BorderThickness、TextBrush属性，即可美化一下进度条，如果需要做的更好，需要熟练使用Blend的美工进行调整。</pre><br><strong>六、使屏幕上的元素不占位又不可见</strong><br><pre>属性Opacity用于控制对应控件的透明程度。当设置为1时，控件可见度最好；当设置为0时，控件完全不可见。<br>如果你想要隐藏某个元素，但你还是希望它有一个非零的版面大小，那么请不要使用Visibility属性，而应用使用类似于下面的操作。<br>属性Visibility有两个取值，一个是Visible，另一个是Collapsed。而相比之下，取值Collapsed的结果是导致元素的大小为零，从而使之不再占用屏幕布局<br>但是，上面的代码在Windows Phone 7 Silverlight应用程序中导致的结果是，控件TextBlock仍然会占用触摸输入。因此，如果你既不想使之占用屏幕空间，也不想使之占用触摸输入，那么你可以使用如下的代码方案：<br>最后值得注意的是，属性Opacity和Visibility对于子控件也有影响。例如，你设置一个Panel控件的上述两个属性，那么其内部包含的子控件也都受到同样的影响。<br>Visibility的使用<br>控件.Visibility=Visibility.visible或者控件.Visibility=Visibility.Collapsed</pre><br><strong>七、地图加载的进度条</strong><br><pre>利用了Map控件内置的一个Progress事件。<!--progressbar 放在LayoutRoot中-->
<grid horizontalalignment="Center" x:name="progressGrid" verticalalignment="Center" width="200" height="20" margin="5,5,5,5"><br><progressbar x:name="MyProgressBar" minimum="0" maximum="100"><br><textblock x:name="ProgressValueTextBlock" text="100%" horizontalalignment="Center" verticalalignment="Center"><br></textblock></progressbar></grid></pre><br>在esri:Map标签中加入一个事件：Progress=”Map1_Progress”<br><pre>private void Map1_Progress(object sender, ESRI.ArcGIS.ProgressEventArgs e)<br>{<br>if (e.Progress &lt; 100)<br>{<br>progressGrid.Visibility = Visibility.Visible;<br>MyProgressBar.Value = e.Progress;<br>ProgressValueTextBlock.Text = String.Format(“正在处理 {0}%”, e.Progress);<br>}<br>else<br>{<br>progressGrid.Visibility = Visibility.Collapsed;<br>}<br>}</pre><br><strong>八、后台代码中创建和使用ImageBtesh</strong><br><pre>ImageBrush brush=new ImageBrush（）；<br>brush.ImageSource=new BitmapImage(new Uri(“wrox.png”,UriKind.Relative));<br>brush.Stresh=Stretch.FIll;<br>MainRect.Fill=brush;</pre><br><strong>九、地图初始化视野</strong><br><pre>如果想获得地图的默认的初始范围，我们应该在它第一次加载的时候来获取，在地图的范围变化，我们可以在ExtentChanging 和 ExtentChanged 两个事件里来获取地图地图变化前后的范围值。在地图移动或者缩放的时候会触发这两个事件，获取初始范围的代码如下<br>void MyMap_ExtentChanged(object sender, ExtentEventArgs e)<br>{<br>if (e.OldExtent == null)<br>ESRI.ArcGIS.Client.Geometry.Envelope initialExtent = e.NewExtent;<br>}<br>我们在平移或者缩放过程中，地图会有一个过渡动画，我们可以控制动画的时间，默认的情况下缩放的持续时间是1.5秒，平移动画的持续时间是0.75秒，通过设置Map 的PanDuration以及ZoomDuration可以设置，以下是取消动画的操作</pre><br><strong>十、textblock.TextWrapping 属性</strong><br><pre>   TextBlock默认是不自动换行的，如果想TextBlock换行，可以设定属性TextWrapping=”Wrap”。<br> TextBox 固定了长度 肯定字符串过长 就无法全部显示出来</pre><br><strong>十一、地图单位计算</strong><br><pre>在不同的坐标系之间，不同单位之间，转换地图单位<br>///<br>/// 长度(米)转换经纬度差<br>///<br>public static double convertedBufferDistanceToJWD(double bufferDistance)<br>{<br>IUnitConverter unitConverter = new UnitConverterClass();<br>double convertedBufferDistance = unitConverter.ConvertUnits(buff  erDistance,<br>esriUnits.esriMeters, esriUnits.esriDecimalDegrees);<br>return convertedBufferDistance;<br>}<br> ///<br>///经纬度差转换长度(米)<br>///<br>public static double convertedBufferDistanceToMeter(double bufferDistance)<br>{<br>IUnitConverter unitConverter = new UnitConverterClass();<br>double convertedBufferDistance = unitConverter.ConvertUnits(bufferDistance,<br>esriUnits.esriDecimalDegrees, esriUnits.esriMeters); return convertedBufferDistance;<br>}<br>以上以单位米和经纬度作为对比</pre><br><strong>十二、Application Bar（菜单系统）</strong><br><pre>创建新项目，下面有注释，把注释去掉都可以显示了<br>可以采用系统提供的图标，路径为：c:\Program Files\Microsoft SDKs\Windows Phone\V7.0\Icons<br>App Bar：图片规格是48×48像素，背景透明，Bar里面的图标控制在26×26像素，格式是png格式，如果大于的<br>话则超出Bar的区域，图片属性设置为content<br><img src="http://s15.sinaimg.cn/middle/69089285gcb9d8882fcee&amp;690" alt="Application &lt;wbr&gt;Bar（菜单系统）"><br>下面三个五角星和记事本标志的是Application Bar也就是菜单系统，包含：定义带图标按钮（ApplicationBarIconButton）<br>和展开菜单项的显示(不带图标，MenuItem)，建议不要出现返回按钮，最重要最常用的功能放到ApplicationBarIconButton中<br>一、ApplicationBarIconButton（菜单系统按钮）<br>1、最多放4个按钮，再多会有异常（ApplicationBarIconButton）<br>2、属性Opacity（透明度），默认为1（完全不透明），透明是0，半透明是0.5，微软建议三个值（1、0.5、0）<br>二、右边小小白点，点击小白点下面有详情显示，下面的详情内容不带图片（MenuItem）<br>1、MenuItem最多不超过5个，如果超过5个会有滚动条，对客户不友好<br>2、MenuItems的内容长度不要超过屏幕宽度，超过会被屏幕截断<br>前台代码：<br><phone:phoneapplicationpage.applicationbar><br>&lt;<wbr> <wbr> <wbr> <wbr> !–带图标按钮–&gt;<br><wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbar isvisible="True" ismenuenabled="True"><br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbariconbutton<wbr> IconUri=”/Image/appbar.minus.rest.png” Text=”缩小”&gt;</shell:applicationbariconbutton<wbr>&gt;<br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbariconbutton<wbr> IconUri=”/Image/appbar.new.rest.png” Text=”放大”&gt;</shell:applicationbariconbutton<wbr>&gt;<br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbariconbutton<wbr> IconUri=”/Images/appbar.save.rest.png” Text=”平移”&gt;</shell:applicationbariconbutton<wbr>&gt;<br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <!--展开菜单项下面的显示，不带图标的显示--><br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbar.menuitems><br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbarmenuitem <wbr="">Text=”保存”&gt;</shell:applicationbarmenuitem><br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> <shell:applicationbarmenuitem text="保存"></shell:applicationbarmenuitem><br><wbr>  <wbr>  <wbr>  <wbr>  <wbr>  <wbr> </shell:applicationbar.menuitems><br><wbr>  <wbr>  <wbr>  <wbr> </shell:applicationbar><br><wbr>  <wbr> </phone:phoneapplicationpage.applicationbar><br>后台代码：<br>动态加入ApplicationBarIconButton： ApplicationBarIconButton iconButton=new ApplicationBarIconButton（）； iconButton.IconUri=new Uri(“/Images/appbar.save.rest.png”,UriKind.Relative); iconButton.Text=””; this.AplicationBar.Buttons.Add(iconButton); iconButton.Click+=new EventElandr(iconButton_click); void iconButton_Click(object sender,EnentArgs e) { } 隐藏按钮：(this.ApplicationBar.Buttons[隐藏的索引] as ApplicationBarIconButton).IsEnabled=false,显示为true</pre><br><strong>十二、以下是取消地图动画的操作</strong><br>我们在平移或者缩放过程中，地图会有一个过渡动画，我们可以控制动画的时间，默认的情况下缩放的持续时间是1.5秒，平移动画的持续时间是0.75秒，通过设置Map 的PanDuration以及ZoomDuration可以设置，以下是取消动画的操作</frameworkelement></li>
</ul>
<esri:map x:name="MyMap" zoomduration="00:00:00" panduration="00:00:00">

<p></p></esri:map><p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/06/04/20132015/WP中比例尺的使用/" itemprop="url">
                  WP中比例尺的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-06-04T14:27:59+08:00" content="2013-06-04">
              2013-06-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><strong><span style="text-decoration: underline;">Setting the MapUnit Property:</span></strong></p>
<p>For the ScaleLine to function correctly, it is possible to set the <a href="http://help.arcgis.com/en/webapi/silverlight/apiref/ESRI.ArcGIS.Client.Toolkit~ESRI.ArcGIS.Client.Toolkit.ScaleLine~MapUnit.html" target="_blank" rel="external">MapUnit</a> to whatever unit the Map’s <a href="http://help.arcgis.com/en/webapi/silverlight/apiref/ESRI.ArcGIS.Client~ESRI.ArcGIS.Client.Geometry.SpatialReference.html" target="_blank" rel="external">SpatialReference</a> is using. For example: if the Map’s SpatialReference is based on a Geographic coordinate system use DecimalDegrees (aka. Longitude/Latitude) units; if it is a UTM or WebMercator (SRID=102100) projection use Meters.</p>
<p>When the Map is using Geographic units (ie. DecimalDegrees) or WebMercator projection, the approximate scale will be calculated at the center of the map. If any other units are used, a direct conversion between MapUnit’s and Metric/US units is used and scale distortion is not taken into account.</p>
<p><strong><span style="text-decoration: underline;">Default MapUnit:</span></strong></p>
<p>If the <a href="http://help.arcgis.com/en/webapi/silverlight/apiref/ESRI.ArcGIS.Client.Toolkit~ESRI.ArcGIS.Client.Toolkit.ScaleLine~MapUnit.html" target="_blank" rel="external">MapUnit</a> is not set manually, the scale line control will use a default map unit which is calculated from the spatial reference of the map or from the <a href="http://help.arcgis.com/en/webapi/silverlight/apiref/ESRI.ArcGIS.Client~ESRI.ArcGIS.Client.ArcGISTiledMapServiceLayer~Units.html" target="_blank" rel="external">ESRI.ArcGIS.Client.ArcGISTiledMapServiceLayer.Units</a> of the layers inside the map. If the spatial reference is Geographic WGS84 (SRID=4326) or WebMercator (SRID=102100), the default MapUnit will be DecimalDegrees and Meters respectively. For others spatial references, the scale line will look at the Units property of the layers having the same spatial reference than the map. If no layers are found, the default DecimalDegrees will be used.</p>
<p><strong><span style="text-decoration: underline;">Controling the text on the ScaleLine:</span></strong></p>
<p>It is not possibly to directly control the values of the text on the ScaleLine as a Property that can be set. The text as part of the ScaleLine that displays is automatically adjusted as the scale of the map changes when the ScaleLine is bound to a Map Control. This also means that it is not possible to control the scale (ie. zoom level) of the Map Control via a Property of the ScaleLine Control.</p>
<p><strong><span style="text-decoration: underline;">ScaleBar style</span></strong></p>
<p>The ScaleLine control replaces the ScaleBar control, which is deprecated. You can apply a template to the ScaleLine control to render with the same look and feel as the ScaleBar control. Below is a sample of a ScaleLine style allowing to get a scale bar with metric units.<br>XAML<img src="http://help.arcgis.com/en/webapi/silverlight/apiref/dotnetimages/copycode.gif" alt=""></p>
<pre>&lt;esri:ScaleLine Name="ScaleLine1" Map="{Binding ElementName=Map1}"
     HorizontalAlignment="Left" VerticalAlignment="Top"  
     TargetWidth="400" 
     Foreground="Black" FontFamily="Courier New" FontSize="18" /&gt;</pre>
C#![](http://help.arcgis.com/en/webapi/silverlight/apiref/dotnetimages/copycode.gif)Copy Code
<pre>//Create a new ScaleLine Control and add it to the LayoutRoot (a Grid in the XAML)
ESRI.ArcGIS.Client.Toolkit.ScaleLine ScaleLine1 = new ESRI.ArcGIS.Client.Toolkit.ScaleLine();
LayoutRoot.Children.Add(ScaleLine1);

//Associate the ScaleLine with Map Control (analagous to a OneTime Binding). Most common coding pattern.
ScaleLine1.Map = Map1;

//Alternative Binding Method. Useful if the ScaleLine's Properties will dynamically impact other objects.
//System.Windows.Data.Binding myBinding = new System.Windows.Data.Binding();
//myBinding.ElementName = "Map1";
//ScaleLine1.SetBinding(ESRI.ArcGIS.Client.Toolkit.ScaleLine.MapProperty, myBinding);

//Set the alignment properties relative the hosting Grid Control
ScaleLine1.HorizontalAlignment = System.Windows.HorizontalAlignment.Left;
ScaleLine1.VerticalAlignment = System.Windows.VerticalAlignment.Top;

//Set the Map units for the ScaleLine
ScaleLine1.MapUnit = ESRI.ArcGIS.Client.Toolkit.ScaleLine.ScaleLineUnit.DecimalDegrees;

//Set the target width for the ScaleLine
ScaleLine1.TargetWidth = 400;

//Set ScaleLine color and related Font information
System.Windows.Media.Color myScaleLineColor = Color.FromArgb(255, 0, 0, 0);
ScaleLine1.Foreground = new System.Windows.Media.SolidColorBrush(myScaleLineColor);
ScaleLine1.FontFamily = new FontFamily("Courier New");
ScaleLine1.FontSize = 18;</pre>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/06/04/20132015/windows-phone-emulator/" itemprop="url">
                  windows phone Emulator无法连接到window phone操作系统
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-06-04T13:13:12+08:00" content="2013-06-04">
              2013-06-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <!--StartFragment -->
<div> </div><div>如果出现如下提示，那么就要看看你的适配器，这个虚拟网卡vEthernet (Internal Ethernet Port Windows Phone Emulator Internal Switch)是否启动，如果禁用，启动都OK了</div><div> </div><div><img src="file:///C:/Users/QiuQiang/AppData/Roaming/Tencent/Users/541489552/QQ/WinTemp/RichOle/%603K%60X(4VROCJ%25I3(%7DQ8" alt="">%7D%7DM.jpg)</div>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/05/29/20132015/InfoWindow控件/" itemprop="url">
                  InfoWindow 控件实现通过指定点显示相应信息
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-05-29T11:28:39+08:00" content="2013-05-29">
              2013-05-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="u524D_u53F0UI_uFF1A"><a href="#u524D_u53F0UI_uFF1A" class="headerlink" title="前台UI："></a>前台UI：</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--LayoutRoot 是包含所有页面内容的根网格--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">Grid</span> <span class="attribute">x:Name</span>=<span class="value">"LayoutRoot"</span> <span class="attribute">Background</span>=<span class="value">"Transparent"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">Grid.Resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esri:SimpleRenderer</span> <span class="attribute">x:Key</span>=<span class="value">"MySimpleRenderer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esri:SimpleRenderer.Symbol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esriSymbols:SimpleFillSymbol</span> <span class="attribute">Fill</span>=<span class="value">"#01FFFFFF"</span> <span class="attribute">BorderBrush</span>=<span class="value">"#88000000"</span> <span class="attribute">BorderThickness</span>=<span class="value">"2"</span>&gt;</span><span class="tag">&lt;/<span class="title">esriSymbols:SimpleFillSymbol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">esri:SimpleRenderer.Symbol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">esri:SimpleRenderer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">DataTemplate</span> <span class="attribute">x:Key</span>=<span class="value">"LocationInfoWindowTemplate"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">StackPanel</span> &gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;TextBlock Text="Location:" Foreground="Black" /&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">TextBlock</span> <span class="attribute">Text</span>=<span class="value">"&#123;Binding X, StringFormat=X\=\&#123;0:0.000\&#125;&#125;"</span> <span class="attribute">Foreground</span>=<span class="value">"Black"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">TextBlock</span> <span class="attribute">Text</span>=<span class="value">"&#123;Binding Y, StringFormat=Y\=\&#123;0:0.000\&#125;&#125;"</span> <span class="attribute">Foreground</span>=<span class="value">"Black"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">StackPanel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">DataTemplate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">DataTemplate</span> <span class="attribute">x:Key</span>=<span class="value">"MyFeatureLayerInfoWindowTemplate"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">TextBlock</span> <span class="attribute">Text</span>=<span class="value">"&#123;Binding [shape_area]&#125;"</span> <span class="attribute">Foreground</span>=<span class="value">"Black"</span> <span class="attribute">FontSize</span>=<span class="value">"14"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">DataTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">Grid.Resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esri:Map</span> <span class="attribute">x:Name</span>=<span class="value">"map1"</span> <span class="attribute">WrapAround</span>=<span class="value">"True"</span> <span class="attribute">IsLogoVisible</span>=<span class="value">"False"</span> <span class="attribute">MapGesture</span>=<span class="value">"map1_MapGesture"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esri:GraphicsLayer</span> <span class="attribute">ID</span>=<span class="value">"graphicesLayer"</span> <span class="attribute">Renderer</span>=<span class="value">"&#123;StaticResource MySimpleRenderer&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">esri:Map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esriToolkit:ScaleLine</span> <span class="attribute">HorizontalAlignment</span>=<span class="value">"Left"</span> <span class="attribute">VerticalAlignment</span>=<span class="value">"Bottom"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esriToolkit:InfoWindow</span> <span class="attribute">x:Name</span>=<span class="value">"MyInfoWindow"</span></span><br><span class="line"><span class="attribute">Padding</span>=<span class="value">"2"</span></span><br><span class="line"><span class="attribute">CornerRadius</span>=<span class="value">"20"</span></span><br><span class="line"><span class="attribute">Background</span>=<span class="value">"LightSalmon"</span></span><br><span class="line"><span class="attribute">Map</span>=<span class="value">"&#123;Binding ElementName=map1&#125;"</span></span><br><span class="line"><span class="attribute">ContentTemplate</span>=<span class="value">"&#123;StaticResource MyFeatureLayerInfoWindowTemplate&#125;"</span></span><br><span class="line">/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esriToolkit:InfoWindow</span> <span class="attribute">x:Name</span>=<span class="value">"InfoWindow"</span></span><br><span class="line"><span class="attribute">CornerRadius</span>=<span class="value">"15"</span></span><br><span class="line"><span class="attribute">Background</span>=<span class="value">"White"</span></span><br><span class="line"><span class="attribute">BorderBrush</span>=<span class="value">"Gray"</span></span><br><span class="line"><span class="attribute">BorderThickness</span>=<span class="value">"1"</span></span><br><span class="line"><span class="attribute">Map</span>=<span class="value">"&#123;Binding ElementName=map1&#125;"</span></span><br><span class="line"><span class="attribute">ContentTemplate</span>=<span class="value">"&#123;StaticResource LocationInfoWindowTemplate&#125;"</span></span><br><span class="line">/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">Grid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">phone:PhoneApplicationPage</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="u540E_u53F0"><a href="#u540E_u53F0" class="headerlink" title="后台"></a>后台</h1><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击触屏点</span></span><br><span class="line">private void map1_MapGesture(object sender, Map.MapGestureEventArgs <span class="keyword">e</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">e</span>.Gesture == GestureType.Tap)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">List</span>&lt;Graphic&gt; <span class="keyword">list</span> = new <span class="keyword">List</span>&lt;Graphic&gt;(<span class="keyword">e</span>.DirectlyOver(1));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">list</span>.<span class="keyword">Count</span>&gt;0)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">foreach</span> (Graphic <span class="keyword">g</span> <span class="keyword">in</span> <span class="keyword">list</span>)</span><br><span class="line">&#123;</span><br><span class="line">MyInfoWindow.Anchor = <span class="keyword">e</span>.MapPoint;</span><br><span class="line">MyInfoWindow.IsOpen = true;</span><br><span class="line"><span class="comment">//Since a ContentTemplate is defined, Content will define the DataContext for the ContentTemplate</span></span><br><span class="line">MyInfoWindow.Content = <span class="keyword">g</span>.Attributes;</span><br><span class="line"><span class="comment">// return;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">InfoWindow.Anchor = <span class="keyword">e</span>.MapPoint;</span><br><span class="line">InfoWindow.IsOpen = true;</span><br><span class="line">InfoWindow.Content = <span class="keyword">e</span>.MapPoint;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">private void PhoneApplicationPage_ManipulationCompleted(object sender, System.Windows.<span class="keyword">Input</span>.ManipulationCompletedEventArgs <span class="keyword">e</span>)</span><br><span class="line">&#123;</span><br><span class="line">MyInfoWindow.IsOpen = false;</span><br><span class="line">this.InfoWindow.IsOpen = false;</span><br><span class="line">&#125;</span><br><span class="line">如果是mouseClick事件的话：</span><br><span class="line">GraphicsLayer featureLayer = MyMap.Layers[<span class="string">"graphicesLayer"</span>] <span class="keyword">as</span> GraphicsLayer;</span><br><span class="line">System.Windows.Point screenPnt = MyMap.MapToScreen(<span class="keyword">e</span>.MapPoint);</span><br><span class="line"><span class="comment">// Account for difference between Map and application origin</span></span><br><span class="line">GeneralTransform generalTransform = MyMap.TransformToVisual(Application.Current.RootVisual);</span><br><span class="line">System.Windows.Point transformScreenPnt = generalTransform.Transform(screenPnt);</span><br><span class="line">IEnumerable&lt;Graphic&gt; selected =</span><br><span class="line">featureLayer.FindGraphicsInHostCoordinates(transformScreenPnt);</span><br><span class="line"><span class="keyword">foreach</span> (Graphic <span class="keyword">g</span> <span class="keyword">in</span> selected)</span><br><span class="line">&#123;</span><br><span class="line">MyInfoWindow.Anchor = <span class="keyword">e</span>.MapPoint;</span><br><span class="line">MyInfoWindow.IsOpen = true;</span><br><span class="line"><span class="comment">//Since a ContentTemplate is defined, Content will define the DataContext for the ContentTemplate</span></span><br><span class="line">MyInfoWindow.Content = <span class="keyword">g</span>.Attributes;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果前台声明过InfoWindow的话，后台不需要声明了，直接赋值，</span></span><br><span class="line">下面这种是后台写法</span><br><span class="line">InfoWindow <span class="keyword">window</span> = new InfoWindow()</span><br><span class="line">&#123;</span><br><span class="line">Anchor = <span class="keyword">e</span>.MapPoint,</span><br><span class="line">Map = MyMap,</span><br><span class="line">IsOpen = true,</span><br><span class="line">ContentTemplate = LayoutRoot.Resources[<span class="string">"LocationInfoWindowTemplate"</span>]</span><br><span class="line"> <span class="keyword">as</span> System.Windows.DataTemplate,</span><br><span class="line"><span class="comment">//Since a ContentTemplate is defined, Content will define the </span></span><br><span class="line">DataContext <span class="keyword">for</span> the ContentTemplate</span><br><span class="line">Content = <span class="keyword">e</span>.MapPoint</span><br><span class="line">&#125;;</span><br><span class="line">LayoutRoot.Children.Add(<span class="keyword">window</span>);&lt;/pre&gt;</span><br><span class="line">实现的效果：![](http:<span class="comment">//images.cnblogs.com/cnblogs_com/dubaokun/201212/201212162156109541.png)</span></span><br><span class="line"></span><br><span class="line">&amp;nbsp;</span><br><span class="line"></span><br><span class="line">后台手动给InfoWindow 的Content赋值</span><br></pre></td></tr></table></figure>
<h1 id="u524D_u53F0"><a href="#u524D_u53F0" class="headerlink" title="前台"></a>前台</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">Grid.Resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">DataTemplate</span> <span class="attribute">x:Key</span>=<span class="value">"LocationInfoWindowTemplate"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">StackPanel</span> &gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;TextBlock Text="Location:" Foreground="Black" /&gt;</span><br><span class="line">&lt;TextBlock Text="&#123;Binding X, StringFormat=X\=\&#123;0:0.000\&#125;&#125;" Foreground="Black" /&gt;</span><br><span class="line">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">TextBlock</span> <span class="attribute">Text</span>=<span class="value">"&#123;Binding ElementName=responseTextBlock,Path=Text&#125;"</span> <span class="attribute">Foreground</span>=<span class="value">"Black"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">StackPanel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">DataTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">Grid.Resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">TextBlock</span> <span class="attribute">Text</span>=<span class="value">""</span> <span class="attribute">Visibility</span>=<span class="value">"Collapsed"</span> <span class="attribute">Name</span>=<span class="value">"responseTextBlock"</span> <span class="attribute">Height</span>=<span class="value">"50"</span> <span class="attribute">TextAlignment</span>=<span class="value">"Center"</span> <span class="attribute">Foreground</span>=<span class="value">"Blue"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">esriToolkit:InfoWindow</span> <span class="attribute">x:Name</span>=<span class="value">"MyInfo"</span> <span class="attribute">Content</span>=<span class="value">"InfoWindow"</span> <span class="attribute">HorizontalAlignment</span>=<span class="value">"Left"</span> <span class="attribute">CornerRadius</span>=<span class="value">"15"</span> <span class="attribute">Background</span>=<span class="value">"White"</span> <span class="attribute">BorderBrush</span>=<span class="value">"Gray"</span> <span class="attribute">BorderThickness</span>=<span class="value">"1"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">esriToolkit:InfoWindow</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>#后台：<br><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">responseTextBlock.Text=<span class="string">"aaaaaaaaaaaaaaaaaa"</span>;<span class="comment">//Text可以随意的赋值</span></span><br><span class="line"><span class="constant">MyInfo.Anchor</span> = point;</span><br><span class="line"><span class="constant">MyInfo.Map</span> = MyMap;</span><br><span class="line"><span class="constant">MyInfo.IsOpen</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="constant">MyInfo.ContentTemplate</span> = LayoutRoot.Resources[<span class="string">"LocationInfoWindowTemplate"</span>] as System.Windows.DataTemplate;</span><br><span class="line"><span class="comment">//Since a ContentTemplate is defined, Content will define the DataContext for the ContentTemplate</span></span><br><span class="line"><span class="constant">MyInfo.Content</span> = responseTextBlock.Text;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/05/28/20132015/xna手势触控/" itemprop="url">
                  XNA：手势触控
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-05-28T11:34:51+08:00" content="2013-05-28">
              2013-05-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>使用到手势触控操作时，需要引入using Microsoft.Xna.Framework.Input.Touch;</p>
<pre>针对Page页面有三个触控：
ManipulationCompleted：结束触屏
ManipulationDulta：触屏时
ManipulationStart：触屏启动时</pre>
**TouchLocation 用来保存某一个触摸点的状态信息。**
**TouchCollection  是保存了当前所有触控状态（TouchLocation）的集合。**
当我们把一个指头在屏幕上操作，可能会有这样三种动作：按，移动，移开。那么这三个操作在WP7的XNA里如何获取呢？我们就需要了解XNA里的TouchPanel和TouchCollection这两个类
<pre>        TouchCollection touchState= TouchPanel.GetState();
        Foreach(TouchLocation location in touchState)
        {
                switch(location.State)
                {
                    case TouchLocationState.Pressed://按下
                     ……
                    break;

        case TouchLocationState.Moved://移动
                     ……
                    break;

        case TouchLocationState.Released://释放
                     ……
                    break;

        }
        }</pre>
<div>TouchLocation ：
State  触摸状态，包含4个状态
&gt; TouchLocationState.Pressed 表示屏幕被触摸时手指按下的一瞬间
&gt; TouchLocationState.Moved 表示手指按下后正在移动，经过测试可知，在手指按下的一瞬间State为Pressed ，在手指按下后抬起前这段时间内的状态均是Moved
&gt; TouchLocationState.Invalid 无效状态
&gt; TouchLocationState.Released 表示手指抬起的一瞬间
ID 表示当前触摸事件的ID，一个完成的触控事件的过程应该是“Pressed  -&gt; Moved  -&gt; Released ”在这个过程中ID是一致的，用来在多点触摸时区分触摸的每个点。
Position 触摸位置，包含两个属性
&gt; X 当前触摸位置的X轴坐标
&gt; Y 当前触摸位置的Y轴坐标
（横屏全屏情况下，屏幕的左上角坐标为（0，0）右下角坐标为（800,480））
和触控操作类似的还有叫“手势”的，也算复杂的触控吧。</div>
<div>
<pre>TouchPanel.EnabledGestures = GestureType.FreeDrag;
//用来指定手势，必须要先设定，否则报错
if (TouchPanel.EnabledGestures != GestureType.None)
{
switch (TouchPanel.ReadGesture())
{
case GestureType.Tap: //单击
break;
case GestureType.DoubleTap://双击
break;
case GestureType.FreeDrag://自由拖动
break;
case GestureType.DragComplete://拖动完成
break;
case GestureType.Flick://轻弹
break;
case GestureType.Hold://按住不动
break;
case GestureType.HorizontalDrag://横向拖动
break;
case GestureType.None://无手势
break;
case GestureType.Pinch://捏
break;
case GestureType.PinchComplete://捏完
break;
case GestureType.VerticalDrag://纵向拖动
break;
}
}</pre>
</div>
示例一各种手势的测试：
<pre>using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Input.Touch;
using Microsoft.Xna.Framework.Media;

namespace Gestures
{
    /// &lt;summary&gt;
    /// This is the main type for your game
    /// &lt;/summary&gt;
    public class Game1 : Microsoft.Xna.Framework.Game
    {
        GraphicsDeviceManager graphics;
        SpriteBatch spriteBatch;

        SpriteFont spriteFont;

        String message = "Do something";
        Vector2 messagePos = Vector2.Zero;
        Color color = Color.Black;

        public Game1()
        {
            graphics = new GraphicsDeviceManager(this);
            Content.RootDirectory = "Content";

            // Frame rate is 30 fps by default for Windows Phone.
            TargetElapsedTime = TimeSpan.FromTicks(333333);
        }

        /// &lt;summary&gt;
        /// Allows the game to perform any initialization it needs to before starting to run.
        /// This is where it can query for any required services and load any non-graphic
        /// related content.  Calling base.Initialize will enumerate through any components
        /// and initialize them as well.
        /// &lt;/summary&gt;
        protected override void Initialize()
        {
            //添加各种手势的支持
            TouchPanel.EnabledGestures = GestureType.Tap 
  | GestureType.DoubleTap | GestureType.Hold
  | GestureType.HorizontalDrag
  | GestureType.VerticalDrag | GestureType.FreeDrag 
  | GestureType.DragComplete | GestureType.Pinch
  | GestureType.PinchComplete | GestureType.Flick;

            base.Initialize();
        }

        /// &lt;summary&gt;
        /// LoadContent will be called once per game and is the place to load
        /// all of your content.
        /// &lt;/summary&gt;
        protected override void LoadContent()
        {
            // Create a new SpriteBatch, which can be used to draw textures.
            spriteBatch = new SpriteBatch(GraphicsDevice);

            //记载字体资源
            spriteFont = Content.Load&lt;SpriteFont&gt;("SpriteFont1");
        }

        /// &lt;summary&gt;
        /// UnloadContent will be called once per game and is the place to unload
        /// all content.
        /// &lt;/summary&gt;
        protected override void UnloadContent()
        {
            // TODO: Unload any non ContentManager content here
        }

        /// &lt;summary&gt;
        /// Allows the game to run logic such as updating the world,
        /// checking for collisions, gathering input, and playing audio.
        /// &lt;/summary&gt;
        /// &lt;param name="gameTime"&gt;Provides a snapshot of timing values.&lt;/param&gt;
        protected override void Update(GameTime gameTime)
        {
            // Allows the game to exit
      if (GamePad.GetState(PlayerIndex.One).Buttons.Back ==
         ButtonState.Pressed)
                this.Exit();

            //判断手势的类别
            if (TouchPanel.IsGestureAvailable)
            {
                GestureSample gesture = TouchPanel.ReadGesture();
                switch (gesture.GestureType)
                {
                    case GestureType.Tap:
                        message = "That was a Tap";
                        color = Color.Red;
                        break;

                    case GestureType.DoubleTap:
                        message = "That was a Double Tap";
                        color = Color.Orange;
                        break;

                    case GestureType.Hold:
                        message = "That was a Hold";
                        color = Color.Yellow;
                        break;

                    case GestureType.HorizontalDrag:
                        message = "That was a Horizontal Drag";
                        color = Color.Blue;
                        break;

                    case GestureType.VerticalDrag:
                        message = "That was a Vertical Drag";
                        color = Color.Indigo;
                        break;

                    case GestureType.FreeDrag:
                        message = "That was a Free Drag";
                        color = Color.Green;
                        break;

                    case GestureType.DragComplete:
                        message = "Drag gesture complete";
                        color = Color.Gold;
                        break;

                    case GestureType.Flick:
                        message = "That was a Flick";
                        color = Color.Violet;
                        break;

                    case GestureType.Pinch:
                        message = "That was a Pinch";
                        color = Color.Violet;
                        break;

                    case GestureType.PinchComplete:
                        message = "Pinch gesture complete";
                        color = Color.Silver;
                        break;
                }

                messagePos = gesture.Position;
            }

            base.Update(gameTime);
        }

        /// &lt;summary&gt;
        /// This is called when the game should draw itself.
        /// &lt;/summary&gt;
        /// &lt;param name="gameTime"&gt;Provides a snapshot of timing values.&lt;/param&gt;
        protected override void Draw(GameTime gameTime)
        {
            GraphicsDevice.Clear(Color.CornflowerBlue);

            //绘制屏幕的文字
            spriteBatch.Begin();
            spriteBatch.DrawString(spriteFont, message, messagePos, color);
            spriteBatch.End();

            base.Draw(gameTime);
        }
    }
}</pre>
示例二多点触控的测试：
<pre>RootDirectory = "Content";

            // Frame rate is 30 fps by default for Windows Phone.
            TargetElapsedTime = TimeSpan.FromTicks(333333);
        }

        /// &lt;summary&gt;
        /// Allows the game to perform any initialization it needs to before starting to run.
        /// This is where it can query for any required services and load any non-graphic
        /// related content.  Calling base.Initialize will enumerate through any components
        /// and initialize them as well.
        /// &lt;/summary&gt;
        protected override void Initialize()
        {
            // TODO: Add your initialization logic here

            base.Initialize();
        }

        /// &lt;summary&gt;
        /// LoadContent will be called once per game and is the place to load
        /// all of your content.
        /// &lt;/summary&gt;
        protected override void LoadContent()
        {
            // Create a new SpriteBatch, which can be used to draw textures.
            spriteBatch = new SpriteBatch(GraphicsDevice);

            // TODO: use this.Content to load your game content here
            spriteFont = Content.Load&lt;SpriteFont&gt;("SpriteFont1");
        }

        /// &lt;summary&gt;
        /// UnloadContent will be called once per game and is the place to unload
        /// all content.
        /// &lt;/summary&gt;
        protected override void UnloadContent()
        {
            // TODO: Unload any non ContentManager content here
        }

        /// &lt;summary&gt;
        /// Allows the game to run logic such as updating the world,
        /// checking for collisions, gathering input, and playing audio.
        /// &lt;/summary&gt;
        /// &lt;param name="gameTime"&gt;Provides a snapshot of timing values.&lt;/param&gt;
        protected override void Update(GameTime gameTime)
        {
            // Allows the game to exit
            if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
                this.Exit();

            // TODO: Add your update logic here
            touchCollection = TouchPanel.GetState();

            base.Update(gameTime);
        }

        /// &lt;summary&gt;
        /// This is called when the game should draw itself.
        /// &lt;/summary&gt;
        /// &lt;param name="gameTime"&gt;Provides a snapshot of timing values.&lt;/param&gt;
        protected override void Draw(GameTime gameTime)
        {
            GraphicsDevice.Clear(Color.CornflowerBlue);

            // TODO: Add your drawing code here
            spriteBatch.Begin();

            foreach (TouchLocation touch in touchCollection)
                spriteBatch.DrawString(spriteFont, "ID: " + touch.Id.ToString() + " (" +
                    (int)touch.Position.X + "," + (int)touch.Position.Y + ")", touch.Position, Color.White);

            spriteBatch.End();

            base.Draw(gameTime);
        }
    }
}</pre>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/05/28/20132015/Thinkpad取消Fn组合键/" itemprop="url">
                  Thinkpad电脑怎么取消Fn组合键
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-05-28T10:37:37+08:00" content="2013-05-28">
              2013-05-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ThinkPad/" itemprop="url" rel="index">
                    <span itemprop="name">ThinkPad</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>重启电脑—&gt;F1—&gt;进入Bios—&gt;config—&gt;keyboard/mouse—&gt;change to“F1——F12” Keys—&gt;选择Legacy—&gt;保存</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/05/23/20132015/windows-store开发与Wp8开发不同之处2/" itemprop="url">
                  windows store开发与Wp8开发不同之处2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-05-23T18:26:31+08:00" content="2013-05-23">
              2013-05-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p><strong>1. Win8**</strong>中如何从照相机或图库获取<strong><strong>WriteableBitmap</strong></strong>类型的图像<strong><br>这是我在移植中遇到的第一个问题。因为Hello! Papercut应用中对图像的操作非常多，可处理的图像类型，当然要用WriteableBitmap了。还有一种图像类型：BitmapImage，它和WriteableBitmap类型在WP7中相处非常友好，可以按照如下操作方便地将BitmapImage类型的图像转化为WriteableBitmap类型：
</strong>【<strong><strong>WP7</strong></strong>】<strong>
</strong>必要的引用集：<strong><br>using System.Windows.Media;<br>using System.Windows.Media.Imaging;
</strong>代码实现：**<br>BitmapImage bmpImg;<br>WriteableBitmap wbImg;<br>wbImg = new WriteableBitmap(bmpImg);<br>走进Win8的世界，却发现BitmapImage通向WriteableBitmap的桥梁断了，上述转化操作无法再用，原因是Win8中的WriteableBitmap()不再有1个参数的构造函数，只有一个WriteableBitmap(int width, int height)了！我不清楚微软如此改变的初衷是什么，但是对使用者而言，这无异于Windows 8电脑操作系统中没有了“开始”按钮，总让人觉得少了些什么。</p>
<p>这个看似微小的改变却带来了大问题：当我需要通过照相机或相册获取图像且无法提前预知图像大小的时候，我无法获得WriteableBitmap类型的图像进行后续处理了！原因都在于这个仅存的鸡肋又无趣的构造函数：WriteableBitmap(int width, int height).</p>
<p>查阅了大量的技术博文和微软官网提供的代码资料后发现：他们的内容居然都非常非常巧妙的避开了我遇到的这个问题，要么只是获取BitmapImage的图像就停止，不再对它进行后续处理，要么就是按照存放对应图像容器控件的固定大小初始化WriteableBitmap的图像</p>
<p>摸索出了一种又简单又傻瓜的解决方案：先获取BitmapImage类型的图像bmpImg（因为只需要BitmapImage bmpImg = new BitmapImage()即可完成对bmpImg存储空间的初始化，后续不存在图像大小不匹配的问题），再通过构造函数WriteableBitmap(int width, int height)完成WriteableBitmap图像的获取。是的，你猜对了，括号中的两个参数，分别就是已经获取的bmpImg图像的width和height了。下面贴一段示例代码吧，它完成的功能是：调用照相机拍照，并把得到的WriteableBitmap类型的图像在图像控件image1中进行显示，等待后续处理</p>
<p><strong>【Win8】</strong><br><strong>必要的引用集：</strong><br>using Windows.UI.Xaml.Media;<br>using Windows.UI.Xaml.Media.Imaging; //图像类型相关<br>using Windows.Media.Capture; //调用照相机相关<br>using Windows.Storage; //文件操作相关<br>using Windows.Storage.Streams;<br><strong>代码实现：</strong><br>//注意，下面的函数是“按钮”控件的点击事件，“点击”操作触发该函数调用<br>private async void btnShot_Click(object sender, RoutedEventArgs e) //留意async关键字，这个不懂的话去问度娘<br>{</p>
<p>WriteableBitmap srcImage;<br>CameraCaptureUI cct = new CameraCaptureUI();<br>cct.PhotoSettings.Format = CameraCaptureUIPhotoFormat.Png; //set the format of image<br>StorageFile file = await cct.CaptureFileAsync(CameraCaptureUIMode.Photo);<br>if (file != null)<br>{<br>BitmapImage bmpImg = new BitmapImage();<br>using (IRandomAccessStream fileStream = await file.OpenAsync(FileAccessMode.Read))<br>{<br>bmpImg.SetSource(fileStream); // 获取bmpImg<br>srcImage = new WriteableBitmap(bmpImg.PixelWidth, bmpImg.PixelHeight); //根据获取到的bmpImg初始化WriteableBitmap类型<br>}</p>
<p>using (IRandomAccessStream wbFileStream = await file.OpenAsync(FileAccessMode.Read))<br>{<br>srcImage.SetSource(wbFileStream); //成功无误差拿到srcImage<br>}<br>image1.Source = srcImage; //在image1控件显示。</p>
<p>//接着调用你伟大的算法去处理srcImage吧！</p>
<p>}</p>
<p>从图库获取WriteableBitmap的思路同上，不一样的只是对图库的操作，简单贴一下代码：</p>
<p><strong>【Win8】</strong><br><strong>必要的引用集：</strong><br>using Windows.UI.Xaml.Media;<br>using Windows.UI.Xaml.Media.Imaging; //图像类型相关<br>using Windows.Storage; //文件操作相关<br>using Windows.Storage.Streams;<br>using Windows.Storage.Pickers; //文件选择器<br>using Windows.Storage.FileProperties;<br><strong>代码实现：</strong><br>private async void btnGallery_Click(object sender, RoutedEventArgs e)<br>{</p>
<p>FileOpenPicker picker = new FileOpenPicker();<br>picker.SuggestedStartLocation = PickerLocationId.PicturesLibrary;<br>picker.FileTypeFilter.Add(“.png”); //可选的文件后缀设置<br>picker.FileTypeFilter.Add(“.jpeg”);<br>picker.FileTypeFilter.Add(“.jpg”);</p>
<p>StorageFile file = await picker.PickSingleFileAsync();<br>BitmapImage bmpImg = new BitmapImage();<br>if (file != null)<br>{<br>//同btnShot_Click()方法<br>}<br>}</p>
<p><strong>2. Win8**</strong>应用中背景音乐的实现<strong><br>不得不说，这个问题当初也困扰了我良久。记得在</strong>WP7<strong>版本中，实现应用的背景音乐并不难，因为可以通过使用相关的类（非“控件”类）和对应的方法完成这个任务。为了实现背景音乐能在整个应用运行期间都有效，即：不会随着页面的跳转而停止，我把相关的变量声明放在了App.xaml.cs中，具体的实现放在了MainPage.xaml.cs的构造函数中。在此简单贴一下代码：
</strong>【WP7】<strong>
</strong>必要的引用集：<strong><br>using System.Windows.Resources;<br>using Microsoft.Xna.Framework;<br>using Microsoft.Xna.Framework.Audio;
</strong>代码实现：<strong>
</strong>//App.xaml.cs<strong>**中的声明</strong><br>public static Stream stream = null;<br>public static StreamResourceInfo info;<br>public static SoundEffect sound;<br>public static SoundEffectInstance soundInstance;<br><strong>//MainPage.xaml.cs**</strong>中在构造函数<strong><strong>public MainPage()</strong></strong>中的实现<strong><br>//…………………………我的音乐文件sound.wav放在了sound文件夹中<br>App.info = Application.GetResourceStream(new Uri(“sound/sound.wav”, UriKind.Relative));<br>if (App.info != null)<br>{<br>App.stream = App.info.Stream;<br>}<br>App.sound = SoundEffect.FromStream(App.stream); //创建音频播放实例<br>App.soundInstance = App.sound.CreateInstance();<br>App.soundInstance.IsLooped = true; //设置循环播放<br>App.soundInstance.Play(); //启动播放<br>//…………………………<br>但是在</strong>Win8**中，想要重现背景音乐的时候却让我犯了难。一是因为Win8中不再可以引用性能优良的XNA程序集，不再可以调用所提供的友好的方法；二是几乎网上所有的示例，包括微软官网提供的例子都是通过在当前页面添加一个声音控件MediaElement来完成的，这个方法简直糟糕透了，因为页面一跳转，音乐也戛然而止，这是无法忍受的，而谁又能保证一个好玩的应用从头到尾就只有一个页面呢？</p>
<p>网上搜寻无果，必须自己解决了。迷茫的时候我突然意识到一个问题：一般情况下使用控件，都是拖拽到当前设计的页面中，再去实现某个方法事件，比如“点击”，“触控”……用代码实现控件的使用却被我，相信也是被大多数开发者忽略了。灵光一现，顿时敲出了如下代码：</p>
<p><strong>【Win8】</strong><br><strong>必要的引用集：</strong><br>using Windows.UI.Xaml.Media;<br>using Windows.Storage;<br>using Windows.Storage.Streams;<br><strong>代码实现：</strong><br><strong>//App.xaml.cs**</strong>中的变量声明以及在<strong><strong>public App()</strong></strong>构造函数中的实现**<br>public static MediaElement myMediaElement = new MediaElement(); //依然采用MediaElement<br>public static IRandomAccessStream soundStream = null;<br>public App()<br>{<br>//…………………………<br>myMediaElement.AudioCategory = AudioCategory.BackgroundCapableMedia;<br>myMediaElement.IsLooping = true; //循环播放开启<br>}</p>
<p><strong>//MainPage.xaml.cs**</strong>中在<strong><strong>ApplicationPage_Loaded(object sender, RoutedEventArgs e)</strong></strong>方法里实现，这个方法如不懂，可以问谷哥<strong>**.</strong><br>private async void ApplicationPage_Loaded(object sender, RoutedEventArgs e)<br>{<br>if (App.soundStream == null)<br>{<br>string fileLocation = “ms-appx:///sound/“;<br>string filename = “sound.wav”; //音乐文件sound.wav同样在sound文件夹中<br>var fs = RandomAccessStreamReference.CreateFromUri(new Uri(fileLocation + filename));<br>App.soundStream = await fs.OpenReadAsync();<br>App.myMediaElement.SetSource(App.soundStream, “”); //这里已经开始播放了<br>//如要控制“播放”与“停止”，可以如下进行：<br>//App.myMediaElement.Play(); //播放<br>//App.myMediaElement.Stop(); //停止<br>}<br>}</p>
<p>这就完美实现了整个应用程序可以不间断循环播放背景音乐。肿么样，看到这里是不是觉得也特别简单？其实就是思维的一个小小的转变，我们无法为App.xaml设计页面，但是可以通过代码完成对MediaElement控件的使用；虽然“拖拽”控件的方式令人青睐，但是用“代码”这种最原始的方式却可以解决通过“拖拽”无法办到的事情！“不忘初心，方能始终”也是这个道理吧！<br><strong>3. Win8保存图像</strong><br>现在依然能够清楚的记得当初因为这个问题所做过的尝试，几乎不下10种。因为WP7中保存图像的过程实在是太简单太简单了，有了XNA的帮助，一个函数搞定！代码如下：<br><strong>【WP7】</strong><br><strong>必要的引用集：</strong><br>using System.Windows.Media;<br>using System.Windows.Media.Imaging;<br>using Microsoft.Xna.Framework.Media;<br>using System.IO;<br>using System.IO.IsolatedStorage; //独立存储相关<br><strong>代码简贴（保存图像到独立存储根目录下）：</strong><br>using (var store = IsolatedStorageFile.GetUserStoreForApplication())<br>{<br>string fileName = “test.jpg”;<br>IsolatedStorageFileStream fs = store.CreateFile(fileName);<br>Extensions.SaveJpeg(bmpImg, fs, bmpImg.PixelWidth, bmpImg.PixelHeight, 0, 100);<br>fs.Close();<br>}</p>
<p>注意：上面的Extensions.SaveJpeg函数中的bmpImg是你想要保存的WriteableBitmap类型的图像。</p>
<p>WP7里保存图像是不是简单疯了？不要高兴的太早，在Win8中，这一切都变了……</p>
<p>没有了XNA的支持，保存图像真的烦的让人吐血。我曾尝试了将近10种通过不同流之间进行转化来完成图像信息的保存，很不幸的是所有的尝试都以保存的图片无法正常打开告终……贴一下曾经做过的那些努力吧，如果你正在尝试这么做，那么恭喜你，这些路子真心都行不通的。</p>
<p>&nbsp;</p>
<p><strong>【Win8】</strong></p>
<p><strong>必要的引用集：</strong></p>
<p>using Windows.UI.Xaml.Media;</p>
<p>using Windows.UI.Xaml.Media.Imaging;</p>
<p>using Windows.Storage;</p>
<p>using Windows.Storage.Streams;</p>
<p>using Windows.Graphics.Imaging;</p>
<p>using Windows.Graphics.Display;</p>
<p><strong>代码实现：</strong></p>
<p>string fileName = “test.jpg”;</p>
<p>folder = await ApplicationData.Current.LocalFolder.GetFolderAsync(folderName);</p>
<p>//上面的folderName是独立存储中的某个文件夹，自己设定</p>
<p>StorageFile outputFile = await folder.CreateFileAsync(fileName, CreationCollisionOption.ReplaceExisting); //新建文件fileName</p>
<p>//以下是对待保存图像进行编码并存在独立存储的指定文件夹中</p>
<p>IRandomAccessStream stream = await outputFile.OpenAsync(FileAccessMode.ReadWrite);</p>
<p>BitmapEncoder encoder = await BitmapEncoder.CreateAsync(BitmapEncoder.PngEncoderId, stream);</p>
<p>Stream pixelStream = toBeStored.PixelBuffer.AsStream(); // toBeStored是欲保存的WriteableBitmap类型的图像，在本段代码之前生成的</p>
<p>byte[] pixels = new byte[pixelStream.Length];</p>
<p>pixelStream.Read(pixels, 0, pixels.Length);</p>
<p>encoder.SetPixelData(BitmapPixelFormat.Bgra8, BitmapAlphaMode.Straight, (uint)papercut_back.PixelWidth, (uint)papercut_back.PixelHeight, 96.0, 96.0, pixels);</p>
<p>await encoder.FlushAsync();</p>
<p><strong>4. Win8**</strong>保存图像<strong><strong>Win8</strong></strong>数据绑定中，如何从独立存储中动态获取数据**</p>
<p>先贴一个数据绑定的例子，是在DevDiv社区看到的，当时觉着这个例子视觉效果非常好，就想要应用到Win8的Hello! Papercut中了。原文在<a href="http://www.devdiv.com/Windows_8_Metro_App%E5%BC%80%E5%8F%91_38_FlipView%E6%8E%A7%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8-thread-147222-1-1.html" target="_blank" rel="external">点击这里</a></p>
<p>&nbsp;</p>
<p>这个例子涉及到的东西偏多，既有数据绑定的内容，又有用户体验很好的FlipView控件的使用。直接从DevDiv上拿来图展示一下效果，这个控件的效果是不是真的很棒呢！</p>
<p><img src="http://bcs.duapp.com/myabby/201305%2Foriginal_kRu1_51cb000019e41191.jpg" alt=""></p>
<p>可惜的是，上面图中这些照片，原作者采用的是静态绑定的方式，也就是假设这些要显示的图不会再有变动了。但是在实际的应用中，如果想跟进用户对软件的使用情况，从数据库或动态变化的独立存储文件夹中获取图像才是靠谱的做法。</p>
<p>原作者的实现框架如下：</p>
<p>假设上图所示的页面文件是FlipView.xaml，对应的源代码文件自然就是FlipView.xaml.cs了。首先要在FlipView.xaml中声明数据源，如是声明：</p>
<p><img src="http://bcs.duapp.com/myabby/201305%2Foriginal_4ZAF_4a4e000056ae118f.jpg" alt=""></p>
<p>而对应的数据资源（即上图中显示的图片）是在另外一个类文件MainPageViewModel.cs中存放的，而对应的类名则与上图中的“MainPageViewModel”一致。具体代码如下图所示：</p>
<p><img src="http://bcs.duapp.com/myabby/201305%2Foriginal_4S6f_24030000562d118c.jpg" alt=""></p>
<p>可以看到，作者将所有图片逐张列出，此为静态实现。</p>
<p>那如果想要动态实现，也就是：要从独立存储空间的某个文件夹中读取图片文件，又该如何做呢？可能你会想：不就是简单的独立存储那套操作吗，直接替换上面这段繁琐的代码就欧了~</p>
<p>起初我也这么想，但是“想法很美好，实施起来很困难”，这个现象在计算机软件行业太常见了！上面的“美好想法”不能正常实施，因为：</p>
<p>（1） Win8中的独立存储操作是需要异步完成，也就是说，函数前需要有关键字async。但是在构造函数（上图中的public MainPageViewModel()）前面冠上这么一顶帽子，法理不容（Win8不支持），情理上也是说不过去的，此方案只能作罢。</p>
<p>（2） 也许你接着会像我一样如是想：把异步操作写在另外一个函数中，这样就可以冠冕堂皇的完成独立存储的操作，拿到想要显示的图片，剩下的只是在构造函数public MainPageViewModel()中调用这个异步函数即可；实践证明，这个做法并不可行，究其原因，是因为当有上上图（黑色背景的小图）的数据源声明时，所提供的图像资源在构造函数中必须已经是现成的，上述调用异步函数实现独立存储操作的思路是把获取图像的过程放在了另外一个函数中来实现，如此做，图像数据在构造函数中并非现成的，因而是做无法成功进行数据绑定的。</p>
<p>到这里，我得到了启发：既然在MainPageViewModel.cs中，想要显示的图像资源既要在构造函数中现成提供，又要满足动态获取，那我只能有一种解决办法了：在程序进入到这个类的构造函数之前就将想要得到的图像获取完毕！</p>
<p>思路已经很清晰了，我在App.xaml.cs中定义了存储图像资源的全局变量imgList，找一个合适的位置（除了在MainPageViewModel.cs中）访问独立存储空间获取想要的图像并存储在imgList中，然后再在MainPageViewModel.cs的构造函数中将imgList的内容与FlipView控件进行数据绑定，这个good job就完成啦！这样，每次进入图片展示页面时，任何时候显示的都是此时此刻之前产生的所有的美丽图片，再配上这般华丽的FlipView控件，真是精神和视觉双享受！</p>
<hr>
<p>以上4点就是自己在移植过程中摸索出来的个人觉得比较精华的东西了。之所以说是精华，一方面是因为个人觉得这些东西在Win8开发，尤其是跟图像关系更紧密的Win8应用开发中显得非常重要，像获取图像、保存图像这些看似简单的操作，在WP7中可以非常方便的完成，在Win8中却不那么容易，甚至万能的网络也无法帮到你；另一方面，上面遇到的这几个问题都融入了我的个人思考，甚至有的是在数十次失败的尝试后得来的，这些个探索的过程让我沉醉其中，当结果真的实现了我想要的功能的时候，这种感觉非常棒，这种在网络求助无果后独创出来的东西让我感受到强大的向前驱动力！</p>
<p>好吧，4点东西写了这么多。这一点不像技术博文，更像流水日志。额呵呵，随它去吧，写成啥就是啥。下面简单总结一下其他几个部分。</p>
<p><strong>5. WP7 -&gt; Win8**</strong>移植，引用集的替换**</p>
<p>最令人欣慰的一点就在这里了，WP7开发中，你所using的引用集如果以“System.Windows”开头，那么执行全局搜索与替换，将“System.Windows”替换为“Windows.UI.Xaml”是丝毫没错的。更多的Win8引用集的情况可以参考这里：</p>
<p><a href="http://rrurl.cn/81dUfR" target="_blank" rel="external">http://msdn.microsoft.com/zh-cn/library/windows/apps/br211377.aspx#__</a></p>
<p><strong>6. Win8**</strong>屏幕翻转的处理**</p>
<p>在WP7中，可以设置任何页面为Landscape（仅横屏模式）或Portrait（仅竖屏模式），或者二者兼可（通过翻转手机屏幕实现横竖屏切换）。但是在Win8中，这个灵活性没有了，任何页面都默认既有横屏模式又可翻转到竖屏模式。</p>
<p>这就带来一个问题：如果页面布局没有精心考虑，在横屏模式下设计的页面翻转为竖屏就没法正常显示了！如果是以竖屏设计的，同样会遇到横屏时页面一团糟的问题！</p>
<p>在WP7中可以强制是否可翻转，而在Win8中既然你没有权利选择，就只能面对和handle这个问题了！</p>
<p>显然，做过网站或网页，熟悉CSS的觉得这不会是个问题，因为通过CSS可以灰常好的进行页面布局设计，让页面自动去适应不同的屏幕模式。没错，这是一种很好，很专业的解决方法，其缺点就是不够业余……好吧，我没有专业学习过网页设计，CSS我不熟悉，我只能另寻他法了。</p>
<p>这里我跟大家分享一种简单的方式，说白了，就是对每个页面设计Landscape和Portrait两种布局，再让你的设备（平板电脑）去感知屏幕翻转的事件，并在代码中控制页面翻转，具体的实现可以参考下面的例子：</p>
<p><a href="http://rrurl.cn/ogUvch" target="_blank" rel="external">http://www.devdiv.com/_DevDiv%E5%8E%9F%</a></p>
<p><a href="http://rrurl.cn/ogUvch" target="_blank" rel="external">E5%88%9B_Windows_8<em>Metro</em><br>App%E5%BC%80%E5%8F%91<em>8</em>%E5%A</a></p>
<p><a href="http://rrurl.cn/ogUvch" target="_blank" rel="external">4%84%E7%90%86Fullscreen__Snapped%E5%92</a></p>
<p><a href="http://rrurl.cn/ogUvch" target="_blank" rel="external">%8CFilled%E7%8A%B6%E6%80%81<br>-thread-131457-1-1.html</a></p>
<p>BY THE WAY，在这里给大家推荐一个学习Win8开发的好地方，前面忘了说，这里补上，DevDiv社区，很多精美的帖子，我看了之后的感觉是欣喜若狂，如果你有机会接触Win8开发，相信你也会为之动情：</p>
<p><a href="http://rrurl.cn/82tJf2" target="_blank" rel="external">http://www.devdiv.com/Windows_8_Metro_App%E5%BC%80%</a></p>
<p><a href="http://rrurl.cn/82tJf2" target="_blank" rel="external">E5%8F%91Step_by<em>Step—%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0</em></a></p>
<p><a href="http://rrurl.cn/82tJf2" target="_blank" rel="external">2012%E5%B9%B49%E6%9C<br>%8811%E6%97%A5%E6%9B%B4%E6%96%B0_-thread-130633-1-1.html</a></p>
<p><strong>7. WP7**</strong>图像处理<strong><strong> VS. Win8</strong></strong>图像处理**</p>
<p>做过图像处理的童鞋一定很清楚，几乎任何不同开发环境或语言下进行图像处理代码都是不一样的，但是万变不离其宗，其核心框架是没变的（那个两层循环^_^）。下面以“将图像处理为灰度图”为例贴一下WP7和Win8中的区别，再进行任何其他方面的图像处理都可以照猫画虎了。</p>
<p><strong>WP7**</strong>中，将<strong><strong>src</strong></strong>转化为灰度图像：**</p>
<p>public WriteableBitmap toGray(WriteableBitmap src)</p>
<p>{</p>
<p>gray = new WriteableBitmap(src);</p>
<p>int i, j, k;</p>
<p>int row_gray;</p>
<p>byte pixel;</p>
<p>byte R, G, B, A = 0;</p>
<p>int tmp_A = gray.Pixels[0];</p>
<p>A = (byte)((tmp_A &amp; 0xFF000000) &gt;&gt; 24);</p>
<p>for (i = 0; i &lt; gray.PixelHeight; i++)</p>
<p>{</p>
<p>row_gray = i * gray.PixelWidth;</p>
<p>for (j = 0; j &lt; gray.PixelWidth; j++)</p>
<p>{</p>
<p>int pixel_gray = gray.Pixels[row_gray + j];</p>
<p>R = (byte)((pixel_gray &amp; 0x00FF0000) &gt;&gt; 16);</p>
<p>G = (byte)((pixel_gray &amp; 0x0000FF00) &gt;&gt; 8);</p>
<p>B = (byte)(pixel_gray &amp; 0x000000FF);</p>
<p>pixel = (byte)(0.299 <em> R + 0.587 </em> G + 0.114 * B);</p>
<p>R = G = B = pixel;</p>
<p>pixel_gray = (A &lt;&lt; 24) | (R &lt;&lt; 16) | (G &lt;&lt; 8) | B;</p>
<p>gray.Pixels[row_gray + j] = pixel_gray;</p>
<p>}</p>
<p>}</p>
<p>return gray;</p>
<p>}</p>
<p><strong>Win8**</strong>中，<strong><strong>将</strong></strong>src<strong>**转化为灰度图像：</strong></p>
<p>public WriteableBitmap toGray2(WriteableBitmap src)</p>
<p>{</p>
<p>gray = cloneImg(src, gray); //自己写的函数，等效于WP7中的gray = new WriteableBitmap(src); 没办法，谁让Win8的WriteableBitmap()变傻了呢…..</p>
<p>int i, j;</p>
<p>int row_gray, index_gray;</p>
<p>byte pixel;</p>
<p>byte[] temp_src = src.PixelBuffer.ToArray();</p>
<p>byte[] temp_gray = new byte[temp_src.Length];</p>
<p>for (i = 0; i &lt; gray.PixelHeight; i++)</p>
<p>{</p>
<p>row_gray = i * gray.PixelWidth;</p>
<p>for (j = 0; j &lt; gray.PixelWidth; j++)</p>
<p>{</p>
<p>index_gray = (row_gray + j) * 4;</p>
<p>for (int k = 0; k &lt; 3; k++)</p>
<p>temp_gray[index_gray + k] = (byte)(0.299 <em> temp_src[index_gray + 2] + 0.587 </em> temp_src[index_gray + 1] + 0.114 * temp_src[index_gray]);</p>
<p>temp_gray[index_gray + 3] = 255;</p>
<p>}</p>
<p>}</p>
<p>Stream sTemp = gray.PixelBuffer.AsStream();</p>
<p>sTemp.Seek(0, SeekOrigin.Begin);</p>
<p>sTemp.Write(temp_gray, 0, gray.PixelWidth <em> 4 </em> gray.PixelHeight);</p>
<p>return gray;</p>
<p>}</p>
<p>到这里，具体的实现部分就总结完了。下面用两句话把控件相关部分简单说一下。</p>
<p><strong>二、 控件相关</strong></p>
<p><strong>1. WP7**</strong>的枢轴控件<strong><strong> VS. Win8</strong></strong>的<strong>**TopAppBar</strong></p>
<p>不得不说，WP7中的枢轴控件用起来感觉还是很爽的，但是当我的视线转向Win8时，枢轴控件没有了，我必须得寻找一种合理的替换方案了。</p>
<p>幸运的是，Win8提供TopAppBar这个玩意，它出现的位置在屏幕最上方，可以合理利用TopAppBar中的有限个按钮来实现页面的导航。</p>
<p>如果你正愁找不到枢轴控件的替代方案，不妨去试试TopAppBar吧！</p>
<p><strong>2. WP7**</strong>的<strong><strong>ApplicationBar VS. Win8</strong></strong>的<strong>**BottomAppBar</strong></p>
<p>同样，WP7中的ApplicationBar在Win8中也改名易姓了，与TopAppBar遥相呼应，它在Win8中叫BottomAppBar. 使用方法如下，在页面的xaml文件中：</p>
<p>&lt;Page.BottomAppBar&gt;</p>
<p>&lt;AppBar&gt;</p>
<p>&lt;Grid HorizontalAlignment=”Left” Width=”768”&gt;</p>
<p>&lt;Grid.ColumnDefinitions&gt;</p>
<p>&lt;ColumnDefinition Width=”425*”&gt;&lt;/ColumnDefinition&gt;</p>
<p>&lt;ColumnDefinition Width=”248*”&gt;&lt;/ColumnDefinition&gt;</p>
<p>&lt;/Grid.ColumnDefinitions&gt;</p>
<p>&lt;StackPanel Orientation=”Horizontal” Grid.Column=”0” HorizontalAlignment=”Left”&gt;</p>
<p>&lt;Button x:Name=”xx1” Style=”{StaticResource SaveAppBarButtonStyle}” AutomationProperties.Name=”save” Click=”AppBarButton_Click”/&gt;</p>
<p>&lt;/StackPanel&gt;</p>
<p>&lt;StackPanel Orientation=”Horizontal” Grid.Column=”1” HorizontalAlignment=”Right”&gt;</p>
<p>&lt;Button x:Name=”home” Style=”{StaticResource HomeAppBarButtonStyle}” Click=”AppBarButton_Click”/&gt;</p>
<p>&lt;/StackPanel&gt;</p>
<p>&lt;/Grid&gt;</p>
<p>&lt;/AppBar&gt;</p>
<p>&lt;/Page.BottomAppBar&gt;</p>
<p>只需要将上述代码中的BottomAppBar改为TopAppBar即为TopAppBar的使用方法。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/05/23/20132015/windows-store开发与Wp8开发不同之处1/" itemprop="url">
                  windows store开发与Wp8开发不同之处1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-05-23T18:18:59+08:00" content="2013-05-23">
              2013-05-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/WP8/" itemprop="url" rel="index">
                    <span itemprop="name">WP8</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>首先Wp向win8的迁移（各种流之间 的转换）：</p>
<div><br><br>保存图片到本地<br><div id="cnblogs_code_open_aad7898e-6baf-451f-b46b-28ad9f5b6943"><br><pre>private async Task SaveImageFromUrl(string uri, string filename)<br>        {<br><br>            var rass = RandomAccessStreamReference.CreateFromUri(new Uri(uri));<br>            IRandomAccessStream inputStream = await rass.OpenReadAsync();<br>            Stream input = WindowsRuntimeStreamExtensions.AsStreamForRead(inputStream.GetInputStreamAt(0));<br>            try<br>            {<br>                //获取图片扩展名的Guid<br>                StorageFolder folder = KnownFolders.PicturesLibrary;<br>                StorageFile outputFile = await folder.CreateFileAsync(filename, CreationCollisionOption.ReplaceExisting);<br>                using (IRandomAccessStream outputStream = await outputFile.OpenAsync(FileAccessMode.ReadWrite))<br>                {<br>                    Stream output = WindowsRuntimeStreamExtensions.AsStreamForWrite(outputStream.GetOutputStreamAt(0));<br>                    await input.CopyToAsync(output);<br>                    output.Dispose();<br>                    input.Dispose();<br>                }<br>            }<br>            catch (Exception)<br>            {<br>            }<br>        }</pre><br></div><br></div><br>根据图片uri保存到本地的函数，即以上为图片uri和图片名称的转换，另以下三种转换：<br><br>1、FileName转换为Stream，图片可为本地图片，也可为应用程序中图片<br><div><br><br>图片转换为流<br><div id="cnblogs_code_open_4762fed1-99a1-455b-95be-f974294189a6"><br><pre>private async Task&lt;Stream&gt; ImageNameToStream(string filename)<br>        {<br>            try<br>            {<br>                ////本地图片库<br>                //StorageFolder folder = KnownFolders.PicturesLibrary;//本地图片库<br>                //StorageFile storagefile = await folder.GetFileAsync(filename);<br><br>                //应用程序Images文件夹图片<br>                Uri _baseUri = new Uri(“ms-appx:///“);<br>                Uri uri = new Uri(_baseUri, “../Images/“ + filename);<br>                StorageFile storagefile = await StorageFile.GetFileFromApplicationUriAsync(uri);<br><br>                IRandomAccessStream irandom = await storagefile.OpenAsync(FileAccessMode.Read);<br>                Stream outPutstream = irandom.GetInputStreamAt(0).AsStreamForRead();<br>                return outPutstream;<br>            }<br>            catch (Exception ex)<br>            {<br>                return null;<br>            }<br>        }</pre><br><div>2、Stream转换成文件，图片保存到本地流转换成本地图片</div><br></div><br></div><br><div><br><div id="cnblogs_code_open_97cafaf2-6d76-49dd-a505-a7160b157674"><br><pre>private async Task StreamToFileName(Stream inputstream, string filename)<br>        {<br>            try<br>            {<br>                StorageFolder folder = KnownFolders.PicturesLibrary;<br>                StorageFile outputFile = await folder.CreateFileAsync(filename, CreationCollisionOption.ReplaceExisting);<br>                using (IRandomAccessStream output = await outputFile.OpenAsync(FileAccessMode.ReadWrite))<br>                {<br>                    Stream outputstream = WindowsRuntimeStreamExtensions.AsStreamForWrite(output.GetOutputStreamAt(0));<br>                    await inputstream.CopyToAsync(outputstream);<br>                    outputstream.Dispose();<br>                    inputstream.Dispose();<br>                }<br>            }<br>            catch (Exception ex)<br>            {<br>            }<br>        }</pre><br></div><br></div><br>3、图片Uri转换成流网络图片Uri转换成流<br><div><br><div id="cnblogs_code_open_fd849e9e-a8ee-4020-aebd-1fd3ca2257fe"><br><pre>private async Task&lt;Stream&gt; UriToStream(string uri)<br>        {<br>            var rass = RandomAccessStreamReference.CreateFromUri(new Uri(uri));<br>            IRandomAccessStream inputStream = await rass.OpenReadAsync();<br>            Stream input = WindowsRuntimeStreamExtensions.AsStreamForRead(inputStream.GetInputStreamAt(0));<br>            return input;<br>        }</pre><br></div><br></div><br>若有其他流与Metro流之间的转换,参考<a href="http://www.cnblogs.com/jing870812/archive/2012/04/12/2444870.html" target="_blank" rel="external">http://www.cnblogs.com/jing870812/archive/2012/04/12/2444870.html</a><br><br>今天在Stream与IrandomAccessStream之间转换时，感觉很纠结，所以干脆先把想到的一些场景都罗列了一下，希望下次再用的时候就不用这么毛手毛脚的了。。。<br><br><strong>Stream 转IRandomAccessStream</strong><br><div><br><div id="highlighter_554296"><br><table border="0" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td><br><div><br><div><code>方法一：</code></div><br><div><code>byte``[] bytes = StreamToBytes(stream);</code></div><br><div><code>InMemoryRandomAccessStream memoryStream = ``new</code> <code>InMemoryRandomAccessStream();</code></div><br><div><code>DataWriter datawriter = ``new</code> <code>DataWriter(memoryStream.GetOutputStreamAt(0));</code></div><br><div><code>datawriter.WriteBytes(bytes);</code></div><br><div><code>await datawriter.StoreAsync();</code></div><br></div></td><br></tr><br></tbody><br></table><br></div><br></div><br><div><br><div><code>方法二：</code></div><br><div><code>var randomAccessStream = ``new</code> <code>InMemoryRandomAccessStream();</code></div><br><div><code>var outputStream = randomAccessStream.GetOutputStreamAt(0);</code></div><br><div><code>await RandomAccessStream.CopyAsync(stream.AsInputStream(), outputStream);</code></div><br><div></div><br><div><strong>IRandomAccessStream 转 Stream</strong></div><br><div><br><div><code>Stream stream=WindowsRuntimeStreamExtensions.AsStreamForRead(randomStream.GetInputStreamAt(0));</code></div><br><div><strong>Ibuffer转Stream</strong></div><br><div><br><div><code>Stream stream = WindowsRuntimeBufferExtensions.AsStream(buffer);</code></div><br><div><br><br><strong>Stream转Ibuffer</strong><br><div><br><div><br><div id="highlighter_328703"><br><table border="0" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td><br><div><code>&lt;code&gt;MemoryStream memoryStream = ``new</code> <code>MemoryStream();</code></div><br><div><code>if</code> <code>(stream != ``null``)</code></div><br><div><code>``{</code></div><br><div><code>``byte``[] bytes = ReadFully(stream);</code></div><br><div><code>``if</code> <code>(bytes != ``null``)</code></div><br><div><code>``{</code></div><br><div><code>``var binaryWriter = ``new</code> <code>BinaryWriter(memoryStream);</code></div><br><div><code>``binaryWriter.Write(bytes);</code></div><br><div><code>``}</code></div><br><div><code>``}</code></div><br><div><code>``IBuffer buffer=WindowsRuntimeBufferExtensions.GetWindowsRuntimeBuffer(memoryStream,0,(``int``)memoryStream.Length);</code></div></td><br></tr><br></tbody><br></table><br></div><br></div><br><strong>Ibuffer转byte[]</strong><br><div><br><div><code>byte``[] bytes=WindowsRuntimeBufferExtensions.ToArray(buffer,0,(``int``)buffer.Length);</code></div><br><div></div><br><div><strong>Byte[]转Ibuffer</strong></div><br><div><code>WindowsRuntimeBufferExtensions.AsBuffer(bytes,0,bytes.Length);</code></div><br><div></div><br><div><strong>Ibuffer转IrandomAccessStream</strong></div><br><div><br><div><br><div id="highlighter_509672"><br><table border="0" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td><br><div><br><div><code>InMemoryRandomAccessStream inStream = ``new</code> <code>InMemoryRandomAccessStream();</code></div><br><div><code>DataWriter datawriter = ``new</code> <code>DataWriter(inStream.GetOutputStreamAt(0));</code></div><br><div><code>datawriter.WriteBuffer(buffer,0,buffer.Length);</code></div><br><div><code>await datawriter.StoreAsync();</code></div><br></div></td><br></tr><br></tbody><br></table><br></div><br></div><br><em><strong>IrandomAccessStream转Ibuffer</strong></em><br><div><br><div><code>FileInputStream inputStream=randomStream.GetInputStreamAt(0) ``as</code> <code>FileInputStream;</code></div><br><div><br><br><strong>IRandomAccessStream转FileOutputStream</strong><br><div><br><div><code>FileOutputStream outStream= randomStream.GetOutputStreamAt(0) ``as</code> <code>FileOutputStream;</code></div><br><div></div><br><div><strong>Stream转byte[]</strong></div><br><div><br><br>public static byte[] ConvertStreamTobyte(Stream input)<br>{<br>byte[] buffer = new byte[16 <em> 1024];<br>using (MemoryStream ms = new MemoryStream())<br>{<br>int read;<br>while ((read = input.Read(buffer, 0, buffer.Length)) &gt; 0)<br>{<br>ms.Write(buffer, 0, read);<br>}<br>return ms.ToArray();<br>}<br>}<br><strong>Byte转Stream</strong><br><div><code>public</code> <code>Stream BytesToStream(``byte``[] bytes)</code></div><br><div><code>``{</code></div><br><div><code>``Stream stream = ``new</code> <code>MemoryStream(bytes);</code></div><br><div><code>``return</code> <code>stream;</code></div><br><div><code>``}</code></div><br><div><em>*Stream转MemoryStream</em></div></em></div><br><div><br><div><code>public</code> <code>static</code> <code>MemoryStream ConvertStreamToMemoryStream(Stream stream)</code></div><br><div><code>``{</code></div><br><div><code>``MemoryStream memoryStream = ``new</code> <code>MemoryStream();</code></div><br><div><code>``if</code> <code>(stream != ``null``)</code></div><br><div><code>``{</code></div><br><div><code>``byte``[] buffer = ReadFully(stream);</code></div><br><div><code>``if</code> <code>(buffer != ``null``)</code></div><br><div><code>``{</code></div><br><div><code>``var binaryWriter = ``new</code> <code>BinaryWriter(memoryStream);</code></div><br><div><code>``binaryWriter.Write(buffer);</code></div><br><div><code>``}</code></div><br><div><code>``}</code></div><br><div><code>``return</code> <code>memoryStream;</code></div><br><div><code>``}</code></div><br></div><br></div><br></div><br><div></div><br><div></div><br></div><br></div><br>&nbsp;<br><br></div><br></div><br></div><br><div></div><br>&nbsp;<br><br></div><br></div><br></div><br>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/17/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/19/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/uploads/images/logo_ljl.jpg" alt="Spicy sister" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Spicy sister</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">183</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">38</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">65</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Spicy sister</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
